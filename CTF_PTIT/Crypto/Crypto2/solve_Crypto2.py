from z3 import *
from Crypto.Util.number import *

c1 = 32930763137657591245671682661065378907876157470073696324706860924174151413813899545628267737923954182518355580308482582884395083978855627014399016379054293488253402225390954280471448716452508005409111284576745690532031769595122489477338312943614861813951717110271786478521584713391571602054127763725617981811
g = 65556906335252739492138792165542310729847274604215491204377659859487941883331877324828668014945205688539538625347791245434017456867211045274632515903354031987751781443770705945360580464425457828577976457587248703877110979526996451487269992053016854914380845578885990371833497436103486601509329626084083968660
p = 140513998383733505878882484463832810400773610216464396082090299095443413923172235117457913756664550823719549662902317573376081431193542463845487697907226369167600481120163289426938922732100465539059713541309125384262046419688008790735321015697953751228026907656116801742757145900027205145531958711127892554959
c2 = 7670001641599113231861941980345322847092796276245234617022952335365852477157226432010123907328990528181522443870120480148135852521715550020767705947636650531440958788351061564446985872556473800469658897282244374663426300248809407921886806704736303693384639428103469288766910384891882482020192891012087623322
h = 15273528733818364088944825564931416580246804828551511408185386076550844914061247386402976630878359077550812761024414293357647284108322195874431618705318411581501804308347288296685298101428242754270584056686889362688314067600725185045055940503536863894910812191441369971393731456033180082689578691282489630975

y = Int('y')
solver = Solver()
eq = c1 == g * y % p
solver.add(eq)
solver.add(y > 0)
if solver.check() == sat:
    model = solver.model()
    y_solution = model[y].as_long()
    print(f"y =  {y_solution}")
else:
    print("ko co")

# s = 85267080600219125506250985051523500413352782971159025843092012165383378144722120465421974868353166858337897834191538971234332630147185775476490671003480534861413170699030639456012240631144072603136584577795826122464159877569592438690439506898639321600571597493385616464498557081346255243629763441651998587019
y =  82559313940155171724100424983174601161122093362972397116745780555709140804427460987213556652252846319464089764533428529236156695279989357277195698492344999203503864514371067496892119493463052458064881908151082303648037208440392614611827710667344748365855114065406607534592563320937172571268028959931995990121
s = pow(h, y, p)
print(f's = {s}')
m = Int('m')
solver = Solver()
solver.add(m > 0)
solver.add(c2 == m * s % p)
if solver.check() == sat:
    model = solver.model()
    m_value = model[m].as_long()
    print("m =", m_value)
else:
    print("ko co")

m = 857235457579744852925350399027230855569994851358267302207298425361159946614538270244311467419564200509848466628736695408172153661745129336169341
print(long_to_bytes(m).decode())
